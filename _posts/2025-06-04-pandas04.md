---
title: "Pandas ì‹¤ìŠµ Part 5"
date: 2025-06-04
author: "ì •ìš°ë¯¼"
layout: post
categories : pandas
tags: [pandas, python, data-analysis, tutorial]
summary: "Pandasì˜ concat, merge, ì •ê·œí™” ë°©ë²•ì„ ì˜ˆì œ ì¤‘ì‹¬ìœ¼ë¡œ ì‹¤ìŠµí•˜ë©° ì•Œì•„ë´…ë‹ˆë‹¤."
---

# concat, merge, ì •ê·œí™”

Pandasë¥¼ í™œìš©í•œ ë°ì´í„° ë¶„ì„ì—ì„œ ì—¬ëŸ¬ DataFrameì„ í•©ì¹˜ê±°ë‚˜, ë°ì´í„°ë¥¼ ì •ê·œí™”í•´ì•¼ í•˜ëŠ” ê²½ìš°ëŠ” ë§¤ìš° ë¹ˆë²ˆí•˜ê²Œ ë°œìƒí•©ë‹ˆë‹¤. ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” `concat`, `merge`, ê·¸ë¦¬ê³  ì •ê·œí™”(normalization)ì™€ ê´€ë ¨ëœ ì‹¤ìŠµì„ ì˜ˆì œë¡œ ì •ë¦¬í•©ë‹ˆë‹¤.

---

## 1. concat : DataFrameì„ ë‹¨ìˆœí•˜ê²Œ ì—°ê²°í•˜ê¸°

`pd.concat()` í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ ê°œì˜ DataFrameì„ **ìˆ˜ì§ ë˜ëŠ” ìˆ˜í‰**ìœ¼ë¡œ ì´ì–´ë¶™ì¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ìˆ˜ì§ ì—°ê²° (ê¸°ë³¸ ì„¤ì •)
```python
row_concat = pd.concat([df1, df2, df3])
```

## ì¸ë±ìŠ¤ë¥¼ ë¬´ì‹œí•˜ê³  ì—°ê²°
```python
row_concat_index = pd.concat([df1, df2, df3], ignore_index=True)
```

## ì‹œë¦¬ì¦ˆë¥¼ í–‰ìœ¼ë¡œ ì¶”ê°€í•  ë•Œ

```python
new_row_series = pd.Series(['n1', 'n2', 'n3', 'n4'])
pd.concat([df1, new_row_series])
```

ì‹œë¦¬ì¦ˆëŠ” ì—´ ì´ë¦„ì´ ì—†ê¸° ë•Œë¬¸ì— ë³´í†µ DataFrameìœ¼ë¡œ ë§Œë“¤ì–´ ì¶”ê°€í•©ë‹ˆë‹¤.

```python
new_row_df = pd.DataFrame([['n1', 'n2', 'n3', 'n4']], columns=['A', 'B', 'C', 'D'])
pd.concat([df1, new_row_df])
```

## ì—´ ë°©í–¥ìœ¼ë¡œ ì—°ê²°

```python
col_concat = pd.concat([df1, df2, df3], axis="columns")
```

## 2. merge: SQL ìŠ¤íƒ€ì¼ ì¡°ì¸
`pd.merge()` í•¨ìˆ˜ëŠ” ë‘ DataFrameì„ **ê³µí†µëœ ì—´(column)**ì„ ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ˆì¹˜ SQLì˜ `JOIN`ì²˜ëŸ¼ ë™ì‘í•©ë‹ˆë‹¤.

```python
merged_df = pd.merge(site, visited, left_on='name', right_on='site')
```

## ë‹¤ì–‘í•œ ì¡°ì¸ ë°©ì‹

| how   | ì„¤ëª…           |
| ----- | ------------ |
| inner | ì–‘ìª½ ëª¨ë‘ì— ìˆëŠ” ê°’ë§Œ |
| outer | ì–‘ìª½ ëª¨ë‘ í¬í•¨     |
| left  | ì™¼ìª½ ê¸°ì¤€ ì „ì²´     |
| right | ì˜¤ë¥¸ìª½ ê¸°ì¤€ ì „ì²´    |


```python
pd.merge(person, survey, left_on='ident', right_on='person', how='outer')
```

## 3. ë°ì´í„° ì •ê·œí™”: Billboard ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì˜ˆì œë¡œ

ì´ë²ˆì—ëŠ” Billboard ì°¨íŠ¸ ë°ì´í„°ë¥¼ ì˜ˆì œë¡œ ì‚¬ìš©í•˜ì—¬ **ì •ê·œí™”(Normalization)** ê³¼ì •ì„ Pandasë¡œ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤. ì •ê·œí™”ëŠ” ì¤‘ë³µëœ ì •ë³´ë¥¼ ë³„ë„ì˜ í…Œì´ë¸”ë¡œ ë¶„ë¦¬í•´ **ë°ì´í„° ì¤‘ë³µì„ ì¤„ì´ê³  ê´€ë¦¬ íš¨ìœ¨ì„±ì„ ë†’ì´ëŠ” ê¸°ë²•**ì…ë‹ˆë‹¤.

---

## ğŸ”¹ ì›ë³¸ ë°ì´í„° êµ¬ì¡° (billboard_long)

`billboard_long` ë°ì´í„°ëŠ” ì•„ë˜ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ, ê° ê³¡ì˜ ì£¼ì°¨ë³„ ìˆœìœ„ ì •ë³´ë¥¼ ëª¨ë‘ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤.

```python
billboard = pd.read_csv('../data/billboard.csv')

billboard_long = billboard.melt(
    id_vars = ["year", "artist", "track", "time", "date.entered"],
    var_name = "week",
    value_name = "rating",
)
billboard_long
```
| year | artist          | track             | time | date.entered | week      | rating |
| ---- | --------------- | ----------------- | ---- | ------------ | --------- | ------ |
| 2000 | 2 Pac           | Baby Don't Cry... | 4:22 | 2000-02-26   | wk1       | 87.0   |
| 2000 | 2Ge+her         | The Hardest Pa... | 3:15 | 2000-09-02   | wk1       | 91.0   |
| ...  | ...             | ...               | ...  | ...          | ...       | ...    |


ê³¡ ì •ë³´ê°€ ì¤‘ë³µë˜ì–´ ì—¬ëŸ¬ ë²ˆ ë“±ì¥í•˜ê³  ìˆì–´ ê´€ë¦¬ê°€ ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.

### ğŸ”¹ Step 1. ê³¡ ì •ë³´ ì¶”ì¶œ ë° ì¤‘ë³µ ì œê±°
ìš°ì„  ê³¡ë³„ ì •ë³´ë¥¼ ë”°ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.

```python
billboard_songs = billboard_long[["year", "artist", "track", "date.entered"]]
billboard_songs = billboard_songs.drop_duplicates()
```

### ğŸ”¹ Step 2. ê³ ìœ  ID ë¶€ì—¬
ê° ê³¡ì— ê³ ìœ  IDë¥¼ ë¶€ì—¬í•˜ì—¬ ì´í›„ ë°ì´í„°ì™€ ì—°ê²°í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

```python
billboard_songs['id'] = billboard_songs.index + 1
```

ì´ì œ billboard_songsëŠ” ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤.

| year | artist          | track                  | date.entered | id  |
| ---- | --------------- | ---------------------- | ------------ | --- |
| 2000 | 2 Pac           | Baby Don't Cry Keep... | 2000-02-26   | 1   |
| 2000 | 2Ge+her         | The Hardest Part Of... | 2000-09-02   | 2   |
| ...  | ...             | ...                    | ...          | ... |

### ğŸ”¹ Step 3. ì •ê·œí™”ëœ ë°ì´í„° ê²°í•©
ê³¡ë³„ ê³ ìœ  IDë¥¼ ê¸°ì¤€ìœ¼ë¡œ billboard_longê³¼ ë‹¤ì‹œ ì—°ê²°í•©ë‹ˆë‹¤.

```python
billboard_ratings = billboard_long.merge(
    billboard_songs,
    on=["year", "artist", "track", "date.entered"]
)
```

ì´ì œ ì¤‘ë³µë˜ëŠ” ê³¡ ì •ë³´ ëŒ€ì‹  IDë¡œ ì—°ê²°ë©ë‹ˆë‹¤.

### ğŸ”¹ Step 4. ì •ë¦¬ëœ í…Œì´ë¸” êµ¬ì„±
ê³¡ ID, ì£¼ì°¨ ì •ë³´, ì°¨íŠ¸ ìˆœìœ„ë§Œ ë‚¨ê²¨ ìµœì¢… í…Œì´ë¸”ì„ êµ¬ì„±í•©ë‹ˆë‹¤.

```python
billboard_ratings = billboard_ratings[["id", "week", "rating"]]
```

ìµœì¢…ì ìœ¼ë¡œ billboard_ratingsëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ì„ ê°–ìŠµë‹ˆë‹¤.

| id  | week | rating |
| --- | ---- | ------ |
| 1   | wk1  | 87.0   |
| 2   | wk1  | 91.0   |
| 3   | wk1  | 81.0   |
| ... | ...  | ...    |


âœ… ìš”ì•½
ì´ì²˜ëŸ¼ ë°ì´í„°ë¥¼ ì •ê·œí™”í•˜ë©´:

ì¤‘ë³µ ì œê±°ë¡œ ë°ì´í„° ìš©ëŸ‰ì„ ì¤„ì¼ ìˆ˜ ìˆê³ ,

ê³¡ ì •ë³´ì™€ ìˆœìœ„ ì •ë³´ê°€ ëª…í™•íˆ ë¶„ë¦¬ë˜ì–´ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì´ í–¥ìƒë©ë‹ˆë‹¤.

ì´ ë°©ì‹ì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì •ê·œí™” ì›ì¹™ê³¼ë„ ìœ ì‚¬í•˜ë©°, Pandasì—ì„œë„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ë§ˆë¬´ë¦¬
ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” Pandasì—ì„œ ë§ì´ ì“°ì´ëŠ” ì„¸ ê°€ì§€ ê¸°ëŠ¥â€”concat, merge, ì •ê·œí™”â€”ë¥¼ ë‹¤ë¤„ë´¤ìŠµë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ë‹¤ì–‘í•œ í˜•íƒœì˜ ë°ì´í„°ë¥¼ í•©ì¹˜ê±°ë‚˜ ë³‘í•©í•˜ê±°ë‚˜, ì „ì²˜ë¦¬í•  ì¼ì´ ë§ê¸° ë•Œë¬¸ì— ì´ ê¸°ëŠ¥ë“¤ì„ ì˜ ìµí˜€ë‘ë©´ í° ë„ì›€ì´ ë©ë‹ˆë‹¤.

ğŸ“Œ ë‹¤ìŒ í¸ì—ì„œëŠ” groupby, pivot_table ë“± ì§‘ê³„ì™€ ë³€í˜•ì— ê´€í•œ ë‚´ìš©ì„ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤.
